%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Wenneker Article
% Structure Specification File
% Version 1.0 (28/2/17)
%
% This file originates from:
% http://www.LaTeXTemplates.com
% as modified by
% Frits Wenneker
% Vel (vel@LaTeXTemplates.com)
%
% Modified by RWC 03/27/2018
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\usepackage[english]{babel} % English language hyphenation

\usepackage{microtype} % Better typography

\usepackage{amsmath,amsfonts,amsthm} % Math packages for equations


\@ifpackageloaded{xcolor}{%
  \definecolors{DarkGoldenrod}
  \definecolors{Maroon}}%
{%
  \usepackage[svgnames]{xcolor} % Enabling colors by their 'svgnames'
}%

\usepackage[hang, small, labelfont=bf, up, textfont=it]{caption} % Custom captions under/above tables and figures

\usepackage{booktabs} % Horizontal rules in tables

\usepackage{lastpage} % Used to determine the number of pages in the document (for "Page X of Total")

\usepackage{graphicx} % Required for adding images

\usepackage{enumitem} % Required for customising lists
\setlist{noitemsep} % Remove spacing between bullet/numbered list elements

\usepackage{sectsty} % Enables custom section titles
\allsectionsfont{\usefont{OT1}{phv}{b}{n}} % Change the font of all section commands (Helvetica)

%----------------------------------------------------------------------------------------
%	MARGINS AND SPACING
%----------------------------------------------------------------------------------------

\usepackage{geometry} % Required for adjusting page dimensions

\geometry{
	top=.5in, % Top margin
	bottom=.5in, % Bottom margin
	left=.75in, % Left margin
	right=.75in, % Right margin
	includehead, % Include space for a header
	includefoot, % Include space for a footer
	%showframe, % Uncomment to show how the type block is set on the page
}

\setlength{\columnsep}{7mm} % Column separation width

%----------------------------------------------------------------------------------------
%	FONTS
%----------------------------------------------------------------------------------------

\usepackage[T1]{fontenc} % Output font encoding for international characters
\usepackage[utf8]{inputenc} % Required for inputting international characters

\usepackage{XCharter} % Use the XCharter font

%----------------------------------------------------------------------------------------
%	HEADERS AND FOOTERS
%----------------------------------------------------------------------------------------

\usepackage{fancyhdr} % Needed to define custom headers/footers
\pagestyle{fancy} % Enables the custom headers/footers

\renewcommand{\footrulewidth}{0.4pt} % Thin footer rule

\renewcommand{\sectionmark}[1]{\markboth{#1}{}} % Removes the section number from the header when \leftmark is used

\newcommand{\removelinebreaks}[1]{%
  \begingroup\def\\{ }#1\endgroup
}

\newcommand{\diststmt}{}

% Headers
\lhead{} % Left header
\chead{\textit{\removelinebreaks{\thetitle}}} % Center header - currently printing the article title
\rhead{} % Right header

% Footers
\lfoot{} % Left footer
\cfoot{\footnotesize \diststmt}
\rfoot{\footnotesize Page \thepage\ of \pageref{LastPage}} % Right footer, "Page 1 of 2"

% First page
\fancypagestyle{firstpage}{ % Page style for the first page with the title
  \renewcommand{\headrulewidth}{0.0pt} % No header rule
  \fancyhead{}    % Just eliminate the header, not the footer so the distribution statement prints
}

%----------------------------------------------------------------------------------------
%	TITLE SECTION
%----------------------------------------------------------------------------------------

\newcommand{\authorstyle}[1]{{\large\usefont{OT1}{phv}{b}{n}\color{Maroon}#1}} % Authors style (Helvetica)

\newcommand{\institution}[1]{{\footnotesize\usefont{OT1}{phv}{m}{sl}\color{Black}#1}} % Institutions style (Helvetica)

\usepackage{titling} % Allows custom title configuration

\newcommand{\HorRule}{      % Defines the gold horizontal rule around the title
  \color{DarkGoldenrod}
  \noindent
  \rule{\linewidth}{1pt}
}

\pretitle{
  \vspace{-50pt}            % Move the entire title section up
  \HorRule
  \vspace{10pt}             % Horizontal rule before the title
  \fontsize{20}{24}\usefont{OT1}{phv}{b}{n}\selectfont % Helvetica
  \color{Maroon}           % Text colour for the title and author(s)
}

\posttitle{\par\vskip 10pt} % Whitespace under the title

\preauthor{
  \fontsize{14}{24}\usefont{OT1}{phv}{b}{n}\selectfont % Helvetica
}

%\postauthor{\par\vskip 15pt} % Whitespace under the title
\postauthor{\par} % Whitespace under the title

\predate{
  \fontsize{14}{24}\usefont{OT1}{phv}{b}{n}\selectfont % Helvetica
  Uploaded:
}

\postdate{                % Anything that will appear after \author is printed
  \vspace{10pt}             % Space before the rule
  \par
  \HorRule                  % Horizontal rule after the title
  \vspace{10pt}             % Space after the title section
}

%----------------------------------------------------------------------------------------
%	ABSTRACT
%----------------------------------------------------------------------------------------

\usepackage{lettrine} % Package to accentuate the first letter of the text (lettrine)
\usepackage{fix-cm}	% Fixes the height of the lettrine

\newcommand{\initial}[1]{ % Defines the command and style for the lettrine
	\lettrine[lines=3,findent=4pt,nindent=0pt]{% Lettrine takes up 3 lines, the text to the right of it is indented 4pt and further indenting of lines 2+ is stopped
		\color{DarkGoldenrod}% Lettrine colour
		{#1}% The letter
	}{}%
}

\usepackage{xstring} % Required for string manipulation

\newcommand{\lettrineabstract}[1]{
	\StrLeft{#1}{1}[\firstletter] % Capture the first letter of the abstract for the lettrine
	\initial{\firstletter}\textbf{\StrGobbleLeft{#1}{1}} % Print the abstract with the first letter as a lettrine and the rest in bold
}
